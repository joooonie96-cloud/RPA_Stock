name: telegram-daily

on:
  schedule:
    - cron: "45 6 * * 1-5"   # 평일만 KST 15:45 (UTC 06:45)
  workflow_dispatch:

jobs:
  run:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - uses: actions/setup-python@v5
        with:
          python-version: "3.11"

      # 🔹 필요한 파이썬 패키지 설치
      - name: Install Python dependencies
        run: |
          python -m pip install --upgrade pip
          pip install requests beautifulsoup4 selenium

      # 🔹 크롬 + 크롬드라이버 설치 (Selenium이 실제 브라우저로 DOM 긁어오기 위해 필요)
      - name: Install Chrome & Chromedriver
        run: |
          sudo apt-get update
          sudo apt-get install -y chromium-browser chromium-chromedriver
          sudo ln -s /usr/bin/chromium-browser /usr/bin/google-chrome || true
          sudo ln -s /usr/bin/chromedriver /usr/bin/chromedriver || true

      # 🔹 스크립트 실행
      - name: Run script
        env:
          BOT_TOKEN: ${{ secrets.BOT_TOKEN }}
          CHAT_ID: ${{ secrets.CHAT_ID }}
        run: python fetch_and_send.py
